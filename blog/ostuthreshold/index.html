<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<title>Android Development -- Ostu threshold - Shengting Cao&#39;s Note Book</title>
<meta name="viewport" content="width=device-width, initial-scale=1">



  <meta name="generator" content="Hugo 0.64.0" />
  <meta itemprop="name" content="Android Development -- Ostu threshold">
<meta itemprop="description" content="Using Ostu threshold measure hight of person">
<meta itemprop="datePublished" content="2019-06-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-06-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="1230">



<meta itemprop="keywords" content="" />
  <meta property="og:title" content="Android Development -- Ostu threshold" />
<meta property="og:description" content="Using Ostu threshold measure hight of person" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://shengtingcao.top/blog/ostuthreshold/" />
<meta property="article:published_time" content="2019-06-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-06-01T00:00:00+00:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Android Development -- Ostu threshold"/>
<meta name="twitter:description" content="Using Ostu threshold measure hight of person"/>

  

  <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
  
    
      <link rel="stylesheet" href="/css/normalize.css">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,800,900|Source+Sans+Pro:400,700">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css" integrity="sha384-i1LQnF23gykqWXg6jxC2ZbCbUMxyw5gLZY6UiUS98LYV5unm8GWmfkIS6jqJfb4E" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css" />
      
      
      <link rel="stylesheet" href="/css/main.min.0a64f3eede6e78edc2d8b2ca7051e4d9a6379f472dac76b1168733b88d27146a.css" integrity="sha256-CmTz7t5ueO3C2LLKcFHk2aY3n0ctrHaxFoczuI0nFGo=">
      <link rel="stylesheet" href="/css/add-on.css">
    
  
  
  
  
</head>

  <body>
    
<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/">
        
          
            Blog
          
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu">
      
        
          
          
            <a href="/" class="link"><i class='fa fa-home'></i> Home</a>
          
        
      
        
          
          
            <a href="/about/" class="link"><i class='far fa-id-card'></i> About</a>
          
        
      
        
          
          
            <a href="/blog/" class="link"><i class='far fa-newspaper'></i> Blog</a>
          
        
      
        
          
          
            <a href="/categories/" class="link"><i class='fas fa-sitemap'></i> Categories</a>
          
        
      
      <a href="#share-menu" class="share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
      
<a href="/search/" class="link"><i class="fas fa-search"></i> Search</a>

    </menu>
    
<a href="/search/" class="link"><i class="fas fa-search"></i> Search</a>

    <a href="#share-menu" class="share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
    <a href="#lang-menu" class="lang-toggle" lang="en">en</a>
    <a href="#site-nav" class="nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  <menu id="lang-menu" class="flyout-menu">
  <a href="#" lang="en" class="link active">English (en)</a>
  
    
      
    
      
        <a href="/cn" lang="cn" class="no-lang link">中文 (cn)</a>
      
    
      
        <a href="/jp" lang="jp" class="no-lang link">日本語 (jp)</a>
      
    
  
  
</menu>

  
    <menu id="share-menu" class="flyout-menu">
      <h1>Share Post</h1>
      




  
    
    <a href="//twitter.com/share?text=Android%20Development%20--%20Ostu%20threshold&amp;url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" rel="noopener" class="share-btn twitter">
        <i class="fab fa-twitter"></i><p>&nbsp;Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" rel="noopener" class="share-btn facebook">
        <i class="fab fa-facebook"></i><p>&nbsp;Facebook</p>
        </a>
  

  
    <a href="//www.reddit.com/submit?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;title=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn reddit">
          <i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;title=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn linkedin">
            <i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p>
          </a>
  

  
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;description=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn pinterest">
          <i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p>
        </a>
  

  
        <a href="mailto:?subject=Check out this post by %7b%20%20%20%20%20%20%20%20map%5b%5d%7d&amp;body=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" class="share-btn email" data-proofer-ignore>
          <i class="fas fa-envelope"></i><p>&nbsp;Email</p>
        </a>
  


    </menu>
  
</header>

    <div id="wrapper">
      <section id="site-intro">
  <a href="/"><img src="/img/main/logo.jpg" class="circle" width="100" alt="Debug the world! Touch the theory!" /></a>
  <header>
    <h1>Shengting Cao's Note Book</h1>
  </header>
  <main>
    <p>Debug the world! Touch the theory!</p>
  </main>
  
    <footer>
      <ul class="socnet-icons">
        
        <li><a href="//github.com/scao7" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//linkedin.com/in//shengting-steven-cao-aa5672136" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>







<li><a href="//youtube.com/channel/UCDItL8_wS1VLYaSrT6m9BFA" target="_blank" rel="noopener" title="YouTube" class="fab fa-youtube"></a></li>


















<li><a href="mailto:codescao7@gmailcom" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
    </footer>
  
</section>

      <main id="site-main">
        <article class="post">
  <header>
  <div class="title">
    
        <h2><a href="/blog/ostuthreshold/">Android Development -- Ostu threshold</a></h2>
    
    
        <p>Using Ostu threshold measure hight of person</p>
    
</div>
  <div class="meta">
    <time class="published" datetime="2019-06-01 00:00:00 &#43;0000 UTC">
      June 1, 2019
    </time>
    <span class="author">Shengting Cao</span>
    
      <p>6 minutes read</p>
    
  </div>
</header>

  <section id="socnet-share">
    




  
    
    <a href="//twitter.com/share?text=Android%20Development%20--%20Ostu%20threshold&amp;url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" rel="noopener" class="share-btn twitter">
        <i class="fab fa-twitter"></i><p>&nbsp;Twitter</p>
      </a>
  

  
      <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" rel="noopener" class="share-btn facebook">
        <i class="fab fa-facebook"></i><p>&nbsp;Facebook</p>
        </a>
  

  
    <a href="//www.reddit.com/submit?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;title=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn reddit">
          <i class="fab fa-reddit-alien"></i><p>&nbsp;Reddit</p>
        </a>
  

  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;title=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn linkedin">
            <i class="fab fa-linkedin"></i><p>&nbsp;LinkedIn</p>
          </a>
  

  
        <a href="//www.pinterest.com/pin/create/button/?url=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f&amp;description=Android%20Development%20--%20Ostu%20threshold" target="_blank" rel="noopener" class="share-btn pinterest">
          <i class="fab fa-pinterest-p"></i><p>&nbsp;Pinterest</p>
        </a>
  

  
        <a href="mailto:?subject=Check out this post by %7b%20%20%20%20%20%20%20%20map%5b%5d%7d&amp;body=https%3a%2f%2fshengtingcao.top%2fblog%2fostuthreshold%2f" target="_blank" class="share-btn email" data-proofer-ignore>
          <i class="fas fa-envelope"></i><p>&nbsp;Email</p>
        </a>
  


  </section>
  

  <div class="content">
    <h4 id="problem-description">Problem Description</h4>
<p>I am facing the problem to build an Android App to measure a person&rsquo;s waistline, height and hip data. The first step is to find a correct threshold method to generate a good picture for us to build further algorithms.</p>
<h4 id="theory">Theory</h4>
<p>All the Theory of Ostu Threshold is from this paper: <a href="http://webserver2.tecgraf.puc-rio.br/~mgattass/cg/trbImg/Otsu.pdf">Ostu&rsquo;s paper</a>. And the reference <a href="http://hipersayanx.blogspot.com/2016/08/otsu-threshold.html">JavaScript page</a>.</p>
<h4 id="implementation">implementation</h4>
<p>First, I tried to implement the basic code for threshold of a certain value for example: 100.
Here is the Java Code in Android Studio</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span>  <span style="color:#66d9ef">static</span> Bitmap <span style="color:#a6e22e">converImage</span><span style="color:#f92672">(</span>Bitmap original<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
        Bitmap finalImage <span style="color:#f92672">=</span> Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">createBitmap</span><span style="color:#f92672">(</span>original<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>original<span style="color:#f92672">.</span><span style="color:#a6e22e">getConfig</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> colorPixel<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> A<span style="color:#f92672">,</span>R<span style="color:#f92672">,</span>G<span style="color:#f92672">,</span>B<span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> width <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">int</span> height <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> x <span style="color:#f92672">&lt;</span> width<span style="color:#f92672">;</span> x<span style="color:#f92672">+</span><span style="color:#f92672">+</span> <span style="color:#f92672">)</span><span style="color:#f92672">{</span>
            <span style="color:#66d9ef">for</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> 0 <span style="color:#f92672">;</span> y <span style="color:#f92672">&lt;</span> height<span style="color:#f92672">;</span> y<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
                colorPixel <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span>y<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                A <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">alpha</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                R <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">red</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                G <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">green</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                B <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">blue</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>R <span style="color:#f92672">&gt;</span> 100 <span style="color:#f92672">)</span><span style="color:#f92672">{</span>
                    R <span style="color:#f92672">=</span> 255<span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                <span style="color:#66d9ef">else</span><span style="color:#f92672">{</span>
                    R <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
                G<span style="color:#f92672">=</span> R<span style="color:#f92672">;</span>
                B<span style="color:#f92672">=</span> R<span style="color:#f92672">;</span>
                finalImage<span style="color:#f92672">.</span><span style="color:#a6e22e">setPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span>y<span style="color:#f92672">,</span>Color<span style="color:#f92672">.</span><span style="color:#a6e22e">argb</span><span style="color:#f92672">(</span>A<span style="color:#f92672">,</span>R<span style="color:#f92672">,</span>G<span style="color:#f92672">,</span>B<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>

        <span style="color:#66d9ef">return</span> finalImage<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
</code></pre></div><h4 id="modify-the-fixed-threshold-into-ostu-threshold">Modify the fixed threshold into Ostu threshold</h4>
<p>This is the method that applied the Ostu threshold for the colored image</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Bitmap <span style="color:#a6e22e">ostuConvert</span><span style="color:#f92672">(</span>Bitmap original<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
      Bitmap BWimg <span style="color:#f92672">=</span> Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">createBitmap</span><span style="color:#f92672">(</span>original<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getConfig</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span> width <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span> height <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span> A<span style="color:#f92672">,</span> R<span style="color:#f92672">,</span> G<span style="color:#f92672">,</span> B<span style="color:#f92672">,</span> colorPixel<span style="color:#f92672">;</span>

      <span style="color:#66d9ef">double</span> Wcv <span style="color:#f92672">=</span> 0<span style="color:#f92672">,</span> th <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> tPXL <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span>256<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> pxl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">[</span>width<span style="color:#f92672">]</span><span style="color:#f92672">[</span>height<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
      <span style="color:#66d9ef">double</span> Bw<span style="color:#f92672">,</span> Bm<span style="color:#f92672">,</span> Bv<span style="color:#f92672">,</span> Fw<span style="color:#f92672">,</span> Fm<span style="color:#f92672">,</span> Fv<span style="color:#f92672">;</span>
      <span style="color:#66d9ef">int</span> np<span style="color:#f92672">,</span> ImgPix <span style="color:#f92672">=</span> 0<span style="color:#f92672">,</span> fth <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>

      <span style="color:#75715e">// pixel check for histogram //
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> x <span style="color:#f92672">&lt;</span> width<span style="color:#f92672">;</span> x<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> y <span style="color:#f92672">&lt;</span> height<span style="color:#f92672">;</span> y<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

              colorPixel <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

              A <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">alpha</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              R <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">red</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              G <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">green</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              B <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">blue</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

              <span style="color:#66d9ef">int</span> gray <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">.</span><span style="color:#a6e22e">2126</span> <span style="color:#f92672">*</span> R<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">.</span><span style="color:#a6e22e">7152</span> <span style="color:#f92672">*</span> G<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">.</span><span style="color:#a6e22e">0722</span> <span style="color:#f92672">*</span> B<span style="color:#f92672">)</span> <span style="color:#f92672">)</span><span style="color:#f92672">;</span> <span style="color:#75715e">// (int) ( (0.299 * R) + (0.587 * G) + (0.114 * B) );
</span><span style="color:#75715e"></span>              pxl<span style="color:#f92672">[</span>x<span style="color:#f92672">]</span><span style="color:#f92672">[</span>y<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> gray<span style="color:#f92672">;</span>
              tPXL<span style="color:#f92672">[</span>gray<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> tPXL<span style="color:#f92672">[</span>gray<span style="color:#f92672">]</span> <span style="color:#f92672">+</span> 1<span style="color:#f92672">;</span>
              ImgPix <span style="color:#f92672">=</span> ImgPix <span style="color:#f92672">+</span> 1<span style="color:#f92672">;</span>
          <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>
      <span style="color:#75715e">// ----- histo-variance ----- //
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> t <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> t <span style="color:#f92672">&lt;</span> 256<span style="color:#f92672">;</span> t<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
          Bw <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> Bm <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> Bv <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
          Fw <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> Fm <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> Fv <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
          np <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>

          <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>t <span style="color:#f92672">=</span><span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span><span style="color:#f92672">{</span> <span style="color:#75715e">// all white/foreground as t0 ----- //
</span><span style="color:#75715e"></span>              Fw <span style="color:#f92672">=</span> 1<span style="color:#f92672">;</span>

              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> d <span style="color:#f92672">&lt;</span> 256<span style="color:#f92672">;</span> d<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//mean
</span><span style="color:#75715e"></span>                  Fm <span style="color:#f92672">=</span> Fm <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>d <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>d<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Fm <span style="color:#f92672">=</span> Fm <span style="color:#f92672">/</span> ImgPix<span style="color:#f92672">;</span>

              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> e <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> e <span style="color:#f92672">&lt;</span> 256<span style="color:#f92672">;</span> e<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//variance
</span><span style="color:#75715e"></span>                  Fv <span style="color:#f92672">=</span> Fv <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>Math<span style="color:#f92672">.</span><span style="color:#a6e22e">pow</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>e <span style="color:#f92672">-</span> Fm<span style="color:#f92672">)</span><span style="color:#f92672">,</span> 2<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>e<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Fv <span style="color:#f92672">=</span> Fv <span style="color:#f92672">/</span> ImgPix<span style="color:#f92672">;</span>

          <span style="color:#f92672">}</span>
          <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span> <span style="color:#75715e">// main thresholding
</span><span style="color:#75715e"></span>              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> d <span style="color:#f92672">&lt;</span> <span style="color:#f92672">(</span>t<span style="color:#f92672">-</span>1<span style="color:#f92672">)</span><span style="color:#f92672">;</span> d<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span> <span style="color:#75715e">// BG weight &amp; mean + BG pixel
</span><span style="color:#75715e"></span>                  Bw <span style="color:#f92672">=</span> Bw <span style="color:#f92672">+</span> tPXL<span style="color:#f92672">[</span>d<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
                  Bm <span style="color:#f92672">=</span> Bm <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>d <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>d<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                  np <span style="color:#f92672">=</span> np <span style="color:#f92672">+</span> tPXL<span style="color:#f92672">[</span>d<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Bw <span style="color:#f92672">=</span> Bw <span style="color:#f92672">/</span> ImgPix<span style="color:#f92672">;</span>
              Bm <span style="color:#f92672">=</span> Bm <span style="color:#f92672">/</span> np<span style="color:#f92672">;</span>

              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> e <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> e <span style="color:#f92672">&lt;</span> <span style="color:#f92672">(</span>t<span style="color:#f92672">-</span>1<span style="color:#f92672">)</span><span style="color:#f92672">;</span> e<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//BG variance
</span><span style="color:#75715e"></span>                  Bv <span style="color:#f92672">=</span> Bv <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>Math<span style="color:#f92672">.</span><span style="color:#a6e22e">pow</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>e <span style="color:#f92672">-</span> Bm<span style="color:#f92672">)</span><span style="color:#f92672">,</span> 2<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>e<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Bv <span style="color:#f92672">=</span> Bv <span style="color:#f92672">/</span> np<span style="color:#f92672">;</span>

              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> t<span style="color:#f92672">;</span> j <span style="color:#f92672">&lt;</span> 256<span style="color:#f92672">;</span> j<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">// FG weight &amp; mean + BG pixel
</span><span style="color:#75715e"></span>                  Fw <span style="color:#f92672">=</span> Fw <span style="color:#f92672">+</span> tPXL<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
                  Fm <span style="color:#f92672">=</span> Fm <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>j <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>j<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                  np <span style="color:#f92672">=</span> ImgPix <span style="color:#f92672">-</span> np<span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Fw <span style="color:#f92672">=</span> Fw <span style="color:#f92672">/</span> ImgPix<span style="color:#f92672">;</span>
              Fm <span style="color:#f92672">=</span> Fm <span style="color:#f92672">/</span> np<span style="color:#f92672">;</span>

              <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> t<span style="color:#f92672">;</span> k <span style="color:#f92672">&lt;</span> 256<span style="color:#f92672">;</span> k<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//FG variance
</span><span style="color:#75715e"></span>                  Fv <span style="color:#f92672">=</span> Fv <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>Math<span style="color:#f92672">.</span><span style="color:#a6e22e">pow</span><span style="color:#f92672">(</span><span style="color:#f92672">(</span>k <span style="color:#f92672">-</span> Fm<span style="color:#f92672">)</span><span style="color:#f92672">,</span> 2<span style="color:#f92672">)</span> <span style="color:#f92672">*</span> tPXL<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              Fv <span style="color:#f92672">=</span> Fv <span style="color:#f92672">/</span> np<span style="color:#f92672">;</span>

          <span style="color:#f92672">}</span>

          <span style="color:#75715e">// within class variance
</span><span style="color:#75715e"></span>          Wcv <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>Bw <span style="color:#f92672">*</span> Bv<span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#f92672">(</span>Fw <span style="color:#f92672">*</span> Fv<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

          <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>t <span style="color:#f92672">=</span><span style="color:#f92672">=</span> 0<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
              th <span style="color:#f92672">=</span> Wcv<span style="color:#f92672">;</span>
          <span style="color:#f92672">}</span>
          <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>Wcv <span style="color:#f92672">&lt;</span> th<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
              th <span style="color:#f92672">=</span> Wcv<span style="color:#f92672">;</span>
              fth <span style="color:#f92672">=</span> t<span style="color:#f92672">;</span>
          <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>

      <span style="color:#75715e">// set binarize pixel
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> x <span style="color:#f92672">&lt;</span> width<span style="color:#f92672">;</span> x<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> y <span style="color:#f92672">&lt;</span> height<span style="color:#f92672">;</span> y<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

              <span style="color:#66d9ef">int</span> fnpx <span style="color:#f92672">=</span> pxl<span style="color:#f92672">[</span>x<span style="color:#f92672">]</span><span style="color:#f92672">[</span>y<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
              colorPixel <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

              A <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">alpha</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

              <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>fnpx <span style="color:#f92672">&gt;</span> fth<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//R &gt; fth
</span><span style="color:#75715e"></span>                  fnpx <span style="color:#f92672">=</span> 255<span style="color:#f92672">;</span>
                  BWimg<span style="color:#f92672">.</span><span style="color:#a6e22e">setPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">,</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">argb</span><span style="color:#f92672">(</span>A<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
              <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
                  fnpx <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
                  BWimg<span style="color:#f92672">.</span><span style="color:#a6e22e">setPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">,</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">argb</span><span style="color:#f92672">(</span>A<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">,</span> fnpx<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
              <span style="color:#f92672">}</span>
          <span style="color:#f92672">}</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">return</span> BWimg<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
</code></pre></div><h4 id="height-calculation">Height Calculation</h4>
<p>The Height Calculation is just count the pixel in the height. So we can apply the method above and change a little. In the last for loop: &ldquo;//set binarize pixel&rdquo; we modify the method as following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#66d9ef">float</span> top <span style="color:#f92672">=</span>  Float<span style="color:#f92672">.</span><span style="color:#a6e22e">POSITIVE_INFINITY</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">float</span> bottom <span style="color:#f92672">=</span>  Float<span style="color:#f92672">.</span><span style="color:#a6e22e">NEGATIVE_INFINITY</span><span style="color:#f92672">;</span>
    <span style="color:#75715e">// set binarize pixel
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> x <span style="color:#f92672">&lt;</span> width<span style="color:#f92672">;</span> x<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
       <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> y <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> y <span style="color:#f92672">&lt;</span> height<span style="color:#f92672">;</span> y<span style="color:#f92672">+</span><span style="color:#f92672">+</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>

           <span style="color:#66d9ef">int</span> fnpx <span style="color:#f92672">=</span> pxl<span style="color:#f92672">[</span>x<span style="color:#f92672">]</span><span style="color:#f92672">[</span>y<span style="color:#f92672">]</span><span style="color:#f92672">;</span>
           colorPixel <span style="color:#f92672">=</span> original<span style="color:#f92672">.</span><span style="color:#a6e22e">getPixel</span><span style="color:#f92672">(</span>x<span style="color:#f92672">,</span> y<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

           A <span style="color:#f92672">=</span> Color<span style="color:#f92672">.</span><span style="color:#a6e22e">alpha</span><span style="color:#f92672">(</span>colorPixel<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

           <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>fnpx <span style="color:#f92672">&gt;</span> fth<span style="color:#f92672">)</span> <span style="color:#f92672">{</span> <span style="color:#75715e">//R &gt; fth
</span><span style="color:#75715e"></span>               fnpx <span style="color:#f92672">=</span> 255<span style="color:#f92672">;</span>
           <span style="color:#f92672">}</span>
           <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
               fnpx <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span>
               <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>top <span style="color:#f92672">&gt;</span> y <span style="color:#f92672">)</span><span style="color:#f92672">{</span>
                   top <span style="color:#f92672">=</span> y<span style="color:#f92672">;</span>
               <span style="color:#f92672">}</span>

               <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>bottom <span style="color:#f92672">&lt;</span> y<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
                   bottom <span style="color:#f92672">=</span> y<span style="color:#f92672">;</span>
               <span style="color:#f92672">}</span>

           <span style="color:#f92672">}</span>
       <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
    <span style="color:#66d9ef">float</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> pointsY <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">float</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span><span style="color:#f92672">{</span> top <span style="color:#f92672">*</span> scaleFactor <span style="color:#f92672">,</span>bottom <span style="color:#f92672">*</span> scaleFactor<span style="color:#f92672">}</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">return</span> pointsY<span style="color:#f92672">;</span>
</code></pre></div><p>I defined the two float variable initialed as POSITIVE_INFINITY and NEGATIVE_INFINITY. When fnpx &lt;= fth begin to calculate the value. Find the minimun role and the maximum role.
I returned the float arrary represent two height value.
I should post the picture of processing but because of the privacy issue I won&rsquo;t post it until this research period end.</p>
<h4 id="draw-line-and-display-pixel-on-the-image-view">Draw line and display pixel on the image view</h4>
<p>After we have the value of top and bottom. I need to draw a red line on the image and display the pixel value between these two.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">drawHeight</span><span style="color:#f92672">(</span>ImageView imgView<span style="color:#f92672">,</span> Bitmap imageBitmap<span style="color:#f92672">)</span><span style="color:#f92672">{</span>
        Bitmap bitmap <span style="color:#f92672">=</span> Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">createBitmap</span><span style="color:#f92672">(</span>imgView<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> imgView<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">Config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ARGB_8888</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">float</span> scaleFactor <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">float</span><span style="color:#f92672">)</span> bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">/</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">float</span><span style="color:#f92672">)</span> imageBitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">float</span><span style="color:#f92672">[</span><span style="color:#f92672">]</span> points <span style="color:#f92672">=</span>customizeMethod<span style="color:#f92672">.</span><span style="color:#a6e22e">ostuCalculateHeight</span><span style="color:#f92672">(</span>imageBitmap<span style="color:#f92672">,</span> scaleFactor<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        Canvas canvas <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Canvas<span style="color:#f92672">(</span>bitmap<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        imgView<span style="color:#f92672">.</span><span style="color:#a6e22e">draw</span><span style="color:#f92672">(</span>canvas<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        Paint paint <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Paint<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        paint<span style="color:#f92672">.</span><span style="color:#a6e22e">setColor</span><span style="color:#f92672">(</span>Color<span style="color:#f92672">.</span><span style="color:#a6e22e">RED</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        paint<span style="color:#f92672">.</span><span style="color:#a6e22e">setStrokeWidth</span><span style="color:#f92672">(</span>10<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

        <span style="color:#66d9ef">float</span> middle <span style="color:#f92672">=</span> imgView<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">/</span> 2<span style="color:#f92672">;</span> <span style="color:#75715e">//x value of the image
</span><span style="color:#75715e"></span>
        canvas<span style="color:#f92672">.</span><span style="color:#a6e22e">drawLine</span><span style="color:#f92672">(</span>middle<span style="color:#f92672">,</span> points<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span><span style="color:#f92672">,</span> middle<span style="color:#f92672">,</span> points<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span><span style="color:#f92672">,</span> paint<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        String pixelInfo <span style="color:#f92672">=</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span><span style="color:#f92672">)</span><span style="color:#f92672">(</span>points<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span> <span style="color:#f92672">-</span> points<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span><span style="color:#f92672">)</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pixels&#34;</span><span style="color:#f92672">;</span>

        paint<span style="color:#f92672">.</span><span style="color:#a6e22e">setColor</span><span style="color:#f92672">(</span>Color<span style="color:#f92672">.</span><span style="color:#a6e22e">GREEN</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        paint<span style="color:#f92672">.</span><span style="color:#a6e22e">setTextSize</span><span style="color:#f92672">(</span>40<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        canvas<span style="color:#f92672">.</span><span style="color:#a6e22e">drawText</span><span style="color:#f92672">(</span>pixelInfo<span style="color:#f92672">,</span>middle<span style="color:#f92672">,</span> <span style="color:#f92672">(</span>points<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">+</span> points<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">/</span>2<span style="color:#f92672">,</span> paint<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#75715e">//draw line on image
</span><span style="color:#75715e"></span>        imgView<span style="color:#f92672">.</span><span style="color:#a6e22e">setImageBitmap</span><span style="color:#f92672">(</span>bitmap<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>I create this method to draw the height. There are two variable we need pass in: imgView and imageBitmap. ImageView refers the view you want to put picture, imageBitmap is the original image in Bitmap data structure.</p>
<h4 id="problems-remain-to-solve">Problems remain to solve</h4>
<h5 id="span-stylecolorblueruntimespan"><!-- raw HTML omitted -->Runtime<!-- raw HTML omitted --></h5>
<p>So far, my app works for measure the height of a person in most circumstance. But the runtime is very slow because I put all the calculation in one thread. There are two option to make the calculation fast. The first one is parallel computing. The second is to use the alternative OpenCV solution, it might faster than my solution. So next post I will focus on how to do parallel computing on Android software and how to load OpenCV library and apply the method.</p>
<h5 id="span-stylecolorblueaccurate-of-measurementspan"><!-- raw HTML omitted -->Accurate of measurement<!-- raw HTML omitted --></h5>
<p>For my application, there still some in accurate value because of the limitation of Ostu threshold method. If a person waring dark cloth and has white hair the output will be inaccurate. Therefore, to increase the accurate of the measurement. I need implement another image processing method called Image gradient. I will introduce the implementation in next blog post.</p>
<h4 id="update">Update</h4>
<p>After learning opencv there are a faster way to solve the ostu threshold method. The updated code using OpenCV library. Run time is less than 1s.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ostuThreshold</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">{</span>
    Bitmap bitmap <span style="color:#f92672">=</span> BitmapFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">decodeResource</span><span style="color:#f92672">(</span>getResources<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>images<span style="color:#f92672">[</span>current_image<span style="color:#f92672">]</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Mat Rgba <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mat<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Mat ostuMat <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mat<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Utils<span style="color:#f92672">.</span><span style="color:#a6e22e">bitmapToMat</span><span style="color:#f92672">(</span>bitmap<span style="color:#f92672">,</span>Rgba<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Imgproc<span style="color:#f92672">.</span><span style="color:#a6e22e">cvtColor</span><span style="color:#f92672">(</span>Rgba<span style="color:#f92672">,</span>ostuMat<span style="color:#f92672">,</span>Imgproc<span style="color:#f92672">.</span><span style="color:#a6e22e">COLOR_RGBA2GRAY</span><span style="color:#f92672">,</span>0<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Imgproc<span style="color:#f92672">.</span><span style="color:#a6e22e">threshold</span><span style="color:#f92672">(</span>ostuMat<span style="color:#f92672">,</span>ostuMat<span style="color:#f92672">,</span>0<span style="color:#f92672">,</span>255<span style="color:#f92672">,</span>Imgproc<span style="color:#f92672">.</span><span style="color:#a6e22e">THRESH_OTSU</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Bitmap outputhBitmap <span style="color:#f92672">=</span> Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">createBitmap</span><span style="color:#f92672">(</span>bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">getWidth</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">getHeight</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span>Bitmap<span style="color:#f92672">.</span><span style="color:#a6e22e">Config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">RGB_565</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    Utils<span style="color:#f92672">.</span><span style="color:#a6e22e">matToBitmap</span><span style="color:#f92672">(</span>ostuMat<span style="color:#f92672">,</span>outputhBitmap<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    imageView<span style="color:#f92672">.</span><span style="color:#a6e22e">setImageBitmap</span><span style="color:#f92672">(</span>outputhBitmap<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div>
  </div>
  <footer>
    <ul class="stats">
  
    
    
      <li class="categories">
        <ul>
          
            
            <li><a class="article-category-link" href="https://shengtingcao.top/categories/android-development">Android Development</a></li>
          
        </ul>
      </li>
    
  
  
    <li class="tags">
      <ul>
        <li>None</li>
      </ul>
    </li>
  
</ul>

  </footer>
</article>


<div class="pagination">
  
    <a href="/blog/importopencv/" class="button big previous"><i class="fas fa-angle-left"></i> Android Development -- Import OpenCV</a>
  
  
    <a href="/blog/opencvbasiclibraryintroandroid/" class="button big next">Android Development -- Image Tools <i class="fas fa-angle-right"></i></a>
  
</div>


      </main>
      <section id="site-sidebar">
  
    <section id="recent-posts">
      <header>
        <h1>Recent posts</h1>
      </header>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/deeplearningpaper1/">Deep Learning Road Map Papers: Classification </a></h1>
          <time class="published" datetime="">February 8, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/computervisionnote3/">Computer vision problem and step by step</a></h1>
          <time class="published" datetime="">January 17, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/computervisionnote2/">Computer vision problem and step by step</a></h1>
          <time class="published" datetime="">January 15, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/computervisionnote1/">Computer Vision problem step by step</a></h1>
          <time class="published" datetime="">January 4, 2020</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/classifier/">Classifier Implementation and Problems</a></h1>
          <time class="published" datetime="">September 25, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/probabilitybasics/">Probability Basics</a></h1>
          <time class="published" datetime="">September 25, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          
  <a href="/blog/logisticregression/" class="image featured">
    <img src="/img/2019/09/pic02.jpg" alt="deeplearning">
  </a>


        </section>
        <header>
          <h1><a href="/blog/logisticregression/">Neuron Network Basics</a></h1>
          <time class="published" datetime="">September 21, 2019</time>
        </header>
      </article>
      
      <article class="mini-post">
        <section>
          

        </section>
        <header>
          <h1><a href="/blog/latexsyntax/">LaTex Tutorial</a></h1>
          <time class="published" datetime="">September 18, 2019</time>
        </header>
      </article>
      
      
        <a href="/blog/" class="button">See more</a>
      
    </section>
  

  
    
      <section id="categories">
        <header>
          <h1><a href="/categories">Categories</a></h1>
        </header>
        <ul>
          
            
          
          
          <li>
            
              <a href="/categories/computer-graphics/">computer-graphics<span class="count">6</span></a>
            
          
          <li>
            
              <a href="/categories/android-development/">android-development<span class="count">5</span></a>
            
          
          <li>
            
              <a href="/categories/computer-vision/">computer-vision<span class="count">3</span></a>
            
          
          <li>
            
              <a href="/categories/programming-languages/">programming-languages<span class="count">3</span></a>
            
          
          <li>
            
              <a href="/categories/deep-learning/">deep-learning<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/latex/">latex<span class="count">2</span></a>
            
          
          <li>
            
              <a href="/categories/internet-ssh/">internet-ssh<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/linux/">linux<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/machine-learning/">machine-learning<span class="count">1</span></a>
            
          
          <li>
            
              <a href="/categories/probability/">probability<span class="count">1</span></a>
            
          
          </li>
        </ul>
      </section>
    
  

  <section id="mini-bio">
    <header>
      <h1>About</h1>
    </header>
    <p>Welcome to my page, hope you can get what you want!</p>
    <footer>
      <a href="/about" class="button">Learn More</a>
    </footer>
  </section>
</section>

      <footer id="site-footer">
  
      <ul class="socnet-icons">
        
        <li><a href="//github.com/scao7" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>











<li><a href="//linkedin.com/in//shengting-steven-cao-aa5672136" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>







<li><a href="//youtube.com/channel/UCDItL8_wS1VLYaSrT6m9BFA" target="_blank" rel="noopener" title="YouTube" class="fab fa-youtube"></a></li>


















<li><a href="mailto:codescao7@gmailcom" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
  
  <p class="copyright">
    
      &copy; 2020
      
        Shengting Cao&#39;s Note Book
      
    . <br>
    Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.64.0' target='_blank' rel='noopener'>Hugo</a>
  </p>
</footer>

<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>


<!DOCTYPE html>

<html>
  <head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
  </head>
</html>

      
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vbscript-html.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/css.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/matlab.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/skel/3.0.1/skel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>
  <script src=/js/util.js></script>
  <script src=/js/main.js></script>
  <script src=/js/add-on.js></script>
  





    </div>
  </body>
</html>
